# SSH连接工具

一个功能强大的SSH连接工具，支持交互式命令输入和复制粘贴功能，并内置GM命令模板。

## 功能特性

### 图形界面版本（推荐）
- 🎨 **可视化界面** - 友好的图形操作界面
- ⌨️ **直接输入命令** - 在输出面板直接输入命令，按回车执行
- 📋 **复制粘贴支持** - 完美支持复制粘贴多行命令
- 📚 **GM命令模板** - 可视化选择GM命令，双击插入
- 💾 **连接记录管理** - 自动保存连接记录，支持多个服务器快速切换
- 🔧 **GM模板管理** - 自定义添加、修改、删除GM命令模板
- 🎯 **实时输出** - 实时显示命令执行结果
- ⚡ **自动保存** - 连接成功后自动保存到连接记录

### 命令行版本
- ✅ 支持密码和密钥两种认证方式
- ✅ 交互式命令输入，可直接在输出面板输入命令
- ✅ 支持复制粘贴功能
- ✅ 内置GM命令模板库
- ✅ 支持配置文件管理
- ✅ 支持单命令执行模式

## 安装

### 方式一：使用Python运行（开发模式）

1. 安装Python依赖：
```bash
pip install -r requirements.txt
```

2. 运行程序：
```bash
python ssh_tool_gui.py
```
或双击运行 `start_gui.bat`

### 方式二：使用打包好的EXE程序（推荐）

1. **下载已打包的exe文件**
   - 直接双击运行，无需安装Python
   - 配置文件会在首次运行时自动创建

2. **自己打包exe**
   - 查看 `打包说明.md` 了解详细打包步骤
   - 或直接双击运行 `build_exe.bat` 自动打包

## 快速开始

### Windows用户（推荐）

**方式1: 图形界面版本（最推荐）✨**
```bash
双击运行 start_gui.bat
```
或
```bash
python ssh_tool_gui.py
```
- 可视化界面，操作简单
- 支持直接在输出面板输入命令
- 支持复制粘贴
- 内置GM命令模板选择

**方式2: 使用图形菜单**
```bash
双击运行 start.bat
```

**方式3: 快速连接**
```bash
ssh_connect.bat 192.168.1.100 root password
```

**方式4: 命令行**
```bash
python ssh_tool.py -H 192.168.1.100 -u root -p your_password
```

### Linux/Mac用户

```bash
python ssh_tool.py -H 192.168.1.100 -u root -p your_password
```

## 使用方法

### 基本连接

```bash
python ssh_tool.py -H 192.168.1.100 -u root -p your_password
```

### 直接运行（无参数）

如果直接运行 `python ssh_tool.py`，程序会显示友好的错误提示和使用说明，不会闪退。

### 使用SSH密钥

```bash
python ssh_tool.py -H 192.168.1.100 -u root -k ~/.ssh/id_rsa
```

### 使用配置文件

1. 复制示例配置文件：
```bash
cp config.json.example config.json
```

2. 编辑 `config.json` 填入你的SSH连接信息

3. 使用配置文件连接：
```bash
python ssh_tool.py -H 192.168.1.100 -u root -c config.json
```

### 查看GM命令模板

```bash
python ssh_tool.py -t
```

### 执行单个命令

```bash
python ssh_tool.py -H 192.168.1.100 -u root -p password -e "ls -la"
```

## 主要功能说明

### 连接记录管理

1. **自动保存**：每次成功连接后，自动保存连接信息（主机+端口+用户名+密码）到连接记录
2. **快速连接**：双击连接记录列表中的记录，快速加载连接信息
3. **记录管理**：
   - **加载**：加载选中记录的连接信息到输入框
   - **删除**：删除选中的连接记录
   - **重命名**：重命名连接记录（方便识别）

### GM命令模板管理

1. **查看模板**：点击"查看"按钮查看所有GM命令模板
2. **插入命令**：选择模板后点击"插入"按钮，命令会插入到输入框
3. **管理模板**：点击"管理"按钮打开管理界面，支持：
   - **添加分类**：创建新的命令分类
   - **删除分类**：删除分类（会删除分类下的所有命令）
   - **添加命令**：在选中分类下添加新命令
   - **更新命令**：修改选中命令的信息
   - **删除命令**：删除选中的命令
   - **保存**：保存所有修改

### 交互模式

连接成功后，工具会进入交互模式：

- 直接在输出面板输入命令，按回车执行
- 支持复制粘贴多行命令
- 输入 `exit` 退出连接

## GM命令模板

工具内置了丰富的GM命令模板，包括：

- **玩家管理**: 踢出、封禁、解封、查看玩家信息等
- **物品管理**: 给予物品、移除物品、清空背包等
- **货币管理**: 给予金币、扣除金币、设置金币等
- **等级经验**: 设置等级、给予经验、设置经验等
- **服务器管理**: 保存、重启、关闭、广播消息等
- **权限管理**: 添加权限、移除权限、查看权限等
- **世界管理**: 设置时间、设置天气、传送玩家等

使用 `-t` 参数查看所有可用的GM命令模板。

## 配置文件说明

`config.json` 格式：

```json
{
  "host": "服务器地址",
  "port": 22,
  "username": "用户名",
  "password": "密码（可选，如果使用密钥）",
  "key_file": "SSH密钥文件路径（可选）"
}
```

## 故障排除

### 程序闪退问题

如果程序闪退，可能的原因：

1. **缺少依赖库**
   - 运行 `pip install -r requirements.txt` 安装依赖
   - 或运行 `start.bat` 选择"安装依赖"

2. **参数错误**
   - 直接运行 `python ssh_tool.py` 会显示使用说明
   - 使用 `python ssh_tool.py -h` 查看帮助

3. **连接失败**
   - 检查网络连接
   - 确认SSH服务正在运行
   - 验证用户名和密码

### 常见错误

- **"缺少 paramiko 库"**: 运行 `pip install paramiko`
- **"缺少主机地址"**: 使用 `-H` 参数指定主机，或使用配置文件
- **"认证失败"**: 检查用户名和密码是否正确

## 注意事项

1. 首次连接新服务器时，工具会自动接受SSH主机密钥
2. Windows系统下建议使用 `start.bat` 图形菜单，或使用PowerShell/CMD
3. 密码认证时，如果命令行未提供密码，会安全提示输入（不显示密码）
4. 建议使用SSH密钥认证以提高安全性
5. 所有错误都会显示详细信息，不会静默退出

## 参数说明

```
-H, --host      主机地址（必需）
-P, --port      端口号（默认22）
-u, --username  用户名（必需）
-p, --password  密码
-k, --key       SSH密钥文件路径
-c, --config    配置文件路径（默认config.json）
-t, --template  显示GM命令模板
-e, --execute   执行单个命令后退出
```

## 示例

### 示例1: 连接服务器并执行命令

```bash
python ssh_tool.py -H 192.168.1.100 -u root -p mypass
```

连接后直接输入命令：
```
$ ls -la
$ cd /var/log
$ tail -f app.log
```

### 示例2: 查看GM命令模板

```bash
python ssh_tool.py -t
```

### 示例3: 快速执行命令

```bash
python ssh_tool.py -H 192.168.1.100 -u root -p mypass -e "df -h"
```

## 许可证

MIT License

